CREATE TABLE role (
             person_id INTEGER NOT NULL,
             roles VARCHAR(5) );

CREATE TABLE person (
             person_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
             email_person VARCHAR(128),
             login_person VARCHAR(32) NOT NULL,
             name_person VARCHAR(75),
             password_person VARCHAR(16) NOT NULL );

CREATE TABLE survey (
             survey_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
             description_survey varchar(4096),
             finish_survey TIMESTAMP NOT NULL,
             start_survey TIMESTAMP NOT NULL,
             title_survey VARCHAR(1024) NOT NULL );

CREATE TABLE question (
             question_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
             name_question VARCHAR(1024),
             qtype_id INTEGER NOT NULL,
             qvariant_id INTEGER NOT NULL );

CREATE TABLE survey_questions (
             survey_survey_id INTEGER NOT NULL,
             questions_question_id INTEGER NOT NULL );

CREATE TABLE qtype (
             qtype_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
             name_qtype VARCHAR(5) NOT NULL );

CREATE TABLE qtype_questions (
             qtype_qtype_id INTEGER NOT NULL,
             questions_question_id INTEGER NOT NULL );

CREATE TABLE answer (
             answer_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
             name_answer VARCHAR(16) NOT NULL,
             text_answer VARCHAR(1025) NOT NULL,
             question_id INTEGER NOT NULL );

CREATE TABLE qvariant (
             qvariant_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
             name_qvariant VARCHAR(16) NOT NULL,
             answer_id INTEGER NOT NULL );

CREATE TABLE question_answers (
             question_question_id INTEGER NOT NULL,
             answers_answer_id INTEGER NOT NULL );

CREATE TABLE question_question_variants (
             question_question_id INTEGER NOT NULL,
             question_variants_qvariant_id INTEGER NOT NULL );

ALTER TABLE role
            ADD CONSTRAINT role__person__FK
            FOREIGN KEY (person_id)
            REFERENCES person;

ALTER TABLE person
            ADD CONSTRAINT person__login_person__UK
            UNIQUE (login_person);

ALTER TABLE qtype_questions
            ADD CONSTRAINT qtype__questions__UK
            UNIQUE (questions_question_id);

ALTER TABLE qtype_questions
            ADD CONSTRAINT qtype_questions__question__FK
            FOREIGN KEY (questions_question_id)
            REFERENCES question;

ALTER TABLE qtype_questions
            ADD CONSTRAINT qtype_questions__qtype__FK
            FOREIGN KEY (qtype_qtype_id)
            REFERENCES qtype;


ALTER TABLE question_answers
            ADD CONSTRAINT question_answers__UK
            UNIQUE (answers_answer_id);

ALTER TABLE question_question_variants
            ADD CONSTRAINT question_question_variants__UK
            UNIQUE (question_variants_qvariant_id);

ALTER TABLE survey
            ADD CONSTRAINT survey__UK
            UNIQUE (title_survey);

ALTER TABLE survey_questions
            ADD CONSTRAINT survey_questions__UK
            UNIQUE (questions_question_id);

ALTER TABLE survey_questions
            ADD CONSTRAINT survey_questions__survey__FK
            FOREIGN KEY (survey_survey_id)
            REFERENCES survey;

ALTER TABLE survey_questions
            ADD CONSTRAINT survey_questions__question__FK
            FOREIGN KEY (questions_question_id)
            REFERENCES question;

ALTER TABLE question
            ADD CONSTRAINT question__qtype__FK
            FOREIGN KEY (qtype_id)
            REFERENCES qtype;

ALTER TABLE question
            ADD CONSTRAINT question__survey__FK
            FOREIGN KEY (qvariant_id)
            REFERENCES survey;

ALTER TABLE question_answers
            ADD CONSTRAINT question_answers__answer__FKt
            FOREIGN KEY (answers_answer_id)
            REFERENCES answer;

ALTER TABLE question_answers
            ADD CONSTRAINT question_answers__question__FK
            FOREIGN KEY (question_question_id)
            REFERENCES question;

ALTER TABLE question_question_variants
            ADD CONSTRAINT question_question_variants__qvariant__FK
            FOREIGN KEY (question_variants_qvariant_id)
            REFERENCES qvariant;

ALTER TABLE question_question_variants
            ADD CONSTRAINT question_question_variants__question__FK
            FOREIGN KEY (question_question_id)
            REFERENCES question;

ALTER TABLE qvariant
            ADD CONSTRAINT qvariant__question__FK
            FOREIGN KEY (answer_id)
            REFERENCES question;

ALTER TABLE answer
            ADD CONSTRAINT answer__question__FK
            FOREIGN KEY (question_id)
            REFERENCES question
